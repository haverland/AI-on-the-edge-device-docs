<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://jomjol.github.io/AI-on-the-edge-device-docs/Neural-Network-Types/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Neural Network Types - AI on the Edge Device</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Neural Network Types";
        var mkdocs_page_input_path = "Neural-Network-Types.md";
        var mkdocs_page_url = "/AI-on-the-edge-device-docs/Neural-Network-Types/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
<img src=https://jomjol.github.io/AI-on-the-edge-device-docs//img/logo.png>
    <a href=".." class="icon icon-home"> AI on the Edge Device
</a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Getting Started</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="..">Welcome</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Installation/">Installation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../inital-setup/">Initial Setup</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Hardware-Compatibility/">Hardware Compatibility</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Best-Practice/">Best Practice</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../FAQs/">Frequently Asked Questions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">External Links</span></p>
              <ul>
                  <li class="toctree-l1"><a class="" href="https://github.com/jomjol/AI-on-the-edge-device/releases">Releases</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://jomjol.github.io/AI-on-the-edge-device/index.html">Web Installer/Console</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/jomjol/AI-on-the-edge-device/issues">Place an Issues</a>
                  </li>
                  <li class="toctree-l1"><a class="" href="https://github.com/jomjol/AI-on-the-edge-device/discussions">Join a Discussions</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../ROI-Configuration/">ROI (Region of Interest)</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Choosing-the-Model/">Model Selection</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Neural Network Types</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#overview-neural-network-type">Overview neural network type</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#naming-convention">Naming convention</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#overview-of-trained-types-and-details">Overview of trained types and details</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#analog-pointer-ana-cont_xxxtflite-ana-class100_xxxtflite">Analog Pointer ("ana-cont_XXX.tflite" &amp; "ana-class100_XXX.tflite")</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#types-of-counters-trained">Types of counters trained:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#training-data-needs">Training data needs</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cnn-technical-details">CNN Technical details:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#digits-with-11-classes-dig-class11_xxxtflite">Digits with 11 classes ("dig-class11_XXX.tflite")</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#types-of-counters-trained_1">Types of counters trained:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#training-data-needs_1">Training data needs</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cnn-technical-details_1">CNN Technical details:</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#digits-with-rolling-results-dig-class100_xxxtflite-dig-cont_xxxtflite">Digits with rolling results ("dig-class100_XXX.tflite" &amp; "dig-cont_XXX.tflite")</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#types-of-counters-trained_2">Types of counters trained:</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#training-data-needs_2">Training data needs</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#cnn-technical-details_2">CNN Technical details:</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ota/">Over-The-Air (OTA) Update</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Advanced</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Integration-Home-Assistant/">Integration into Home Assistant</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../External-LED/">External LED</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rolling-installation/">Living on the edge</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Configuration-Parameter-Details/">Configuration Parameter Details</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Configuration/">Configuration</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Watermeter-specific-analog---digital-transition/">Analog/Digital Transition on Watermeters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Learn-models-with-your-own-images/">Learn a model with your own images</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Correction%20Algorithm/">Correction Algorithm</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Additional-Information/">Additional Information</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Troubleshooting</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Error-Codes/">Error Codes</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Error-Debugging/">Error Debugging</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Frequent-Reboots/">Frequent Reboots</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">API's</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../REST-API/">REST API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../MQTT-API/">MQTT API</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Influx-DB/">Influx DB</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Development</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Build-Instructions/">Build the Project</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Demo-Mode/">Demo Mode</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Upload-files-by-script/">Scripted File Upload</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Testing/">Testing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../Release-creation/">Preparing for Release</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Old Pages (no longer maintained)</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../outdated--Integrated-Functions/">Integrated Functions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../outdated--Gasmeter-Log-Downloader/">Gasmeter Log-Downloader</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../outdated--Migrate-Old-Config-To-New-Config/">Migration from water-meter „old“ to water-meter “AI-on-the-edge-device”</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Asorted Pages</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../Graphical-Configuration/">Graphical Configuration</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">AI on the Edge Device</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Configuration &raquo;</li>
      <li>Neural Network Types</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/jomjol/AI-on-the-edge-device-docs/edit/main/docs/Neural-Network-Types.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="neural-network-types">Neural Network Types</h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This page overlaps <a href="../Choosing-the-Model">Choosing the Model</a>. They should be merged to one page!</p>
</div>
<p>This section is describing the different types of neural networks, that are used with the AI-on-the-edge approach and gives an introduction on how and where to use them. </p>
<h2 id="overview-neural-network-type">Overview neural network type</h2>
<p>There are two <strong>types of input</strong>:</p>
<ul>
<li>
<p>digits with rolling number (top town)</p>
</li>
<li>
<p>analog pointers (clockwise rotating pointer) </p>
</li>
</ul>
<p>There are two <strong>types of neural networks</strong>:</p>
<ul>
<li><em>classification networks</em> with discrete output neurons for each result class:</li>
<li>11 classes for digits (0, 1, ... 8, 9 + "Not-A-Number")</li>
<li>100 classes for digits or analog pointers (0.1, 0.2, 0.3, ... , 9.7, 9.8, 9.9)</li>
<li><em>continuous output networks</em> with a continuous output in the interval [0, 10[</li>
</ul>
<p>No setting of the type in the firmware is necessary. The type can detect by the output structure automatically.</p>
<p><strong>‼️ Attention:</strong></p>
<ul>
<li>It is very important to choose the right network type (digits or analog pointers). 
  Technically a wrong network will work and create output, but that would be totally arbitrary</li>
<li>Not all type of pointers are trained in all networks.</li>
<li>For the 11 classes digits network there many different types of digits trained. The reason is, that you 1) only need 20-30 training images and 2) the data collection is ongoing much longer</li>
<li>For the continious and 100 classes network especially for the digits, there are only a few types of digits trained up to now</li>
<li>Therefore sometimes for the digits it is more effective to choose the simpler 11 classes network type (= default). </li>
</ul>
<h2 id="naming-convention">Naming convention</h2>
<table>
<thead>
<tr>
<th></th>
<th>Classification<br />11 classes<br />0, 1, ... 9 + "N"</th>
<th>Classification<br />100 classes<br />0.0, 0.1, ... 9.9</th>
<th>Continuous<br />Interval<br />[0, 10[</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Digits</strong> <br /><img alt="" src="../img/0_arbitrary.jpg" /></td>
<td><strong>dig-class11</strong>_XXX.tflite</td>
<td><strong>dig-class100</strong>_XXX.tflite</td>
<td><strong>dig-cont</strong>_XXX.tflite</td>
</tr>
<tr>
<td><strong>Analog Pointers</strong>  <br /><img alt="" src="../img/ana-examp.jpg" /></td>
<td></td>
<td><strong>ana-class100</strong>_XXX.tflite</td>
<td><strong>ana-cont</strong>_XXX.tflite</td>
</tr>
</tbody>
</table>
<p>XXX contains the versioning and a parameter for different sizes with the following naming:</p>
<p>XXX = versioning_sY</p>
<ul>
<li>
<p>versioning = version or in newer networks the training data</p>
</li>
<li>
<p>Y = Neural network size (typically s1, s2, ..., s4). Whereas s1 is the maximum sized neural network and s4 is the smallest.</p>
</li>
</ul>
<p>Optional the naming ends with an "_q" to signal, that the tflite file has been quantized (size reduction with minimum accuracy loss).</p>
<p>Example: <code>dig-class11_1410_s2_q.tflite</code></p>
<ul>
<li>Classification network for digits with 11 classes (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, N)</li>
<li>Version 1410 = 14.1.0</li>
<li>s2 = Size 2 (Medium)</li>
<li>q = Quantized Version</li>
</ul>
<h2 id="overview-of-trained-types-and-details">Overview of trained types and details</h2>
<h3 id="analog-pointer-ana-cont_xxxtflite-ana-class100_xxxtflite">Analog Pointer ("ana-cont_XXX.tflite" &amp; "ana-class100_XXX.tflite")</h3>
<p>This is to transfer the direction of a pointer into a continuous number between 0 and 1, whereas 0 (=1) is the upwards position (12 o'clock), 0.25 corresponds to the 3 o'clock positions and so on. This network is a envolop for all different types of pointers. Currently there are no dedicated network trainings for specific types of pointers.</p>
<p>There are two types of network structure, currently both are supported. The "class100" is a pure classification network, that might need a bit more accuracy in the labeling. "cont" is a no classic approach with a continuous output off only 2 neurons (details see below).</p>
<h4 id="types-of-counters-trained">Types of counters trained:</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="" src="../img/ana-cont/examp-ana1.jpg" /></td>
<td><img alt="" src="../img/ana-cont/examp-ana2.jpg" /></td>
<td><img alt="" src="../img/ana-cont/examp-ana3.jpg" /></td>
<td><img alt="" src="../img/ana-cont/examp-ana4.jpg" /></td>
</tr>
<tr>
<td><img alt="" src="../img/ana-cont/examp-ana5.jpg" /></td>
<td><img alt="" src="../img/ana-cont/examp-ana6.jpg" /></td>
<td><img alt="" src="../img/ana-cont/examp-ana7.jpg" /></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="training-data-needs">Training data needs</h4>
<ul>
<li>Quadratic images, minimum size: 32x32 pixel</li>
<li>Typically 100 - 200 images with a resultion of 1/100 of the full rotation (every 0.1 value or 3.6°)</li>
<li>Naming: x.y_ARBITRARY.jpg, where x.y = value 0.0 ... 9.9</li>
</ul>
<h4 id="cnn-technical-details">CNN Technical details:</h4>
<h5 id="input">Input</h5>
<ul>
<li>32 x 32 RGB images</li>
</ul>
<h5 id="output">Output</h5>
<ul>
<li><strong>ana-cont</strong>_XXX.tflite:</li>
<li>2 neurons with output in range [-1, 1] - representing a sinus / cosinus encoding of the angle</li>
<li>
<p>needs to be converted to angle with arctan-hyperbolicus function</p>
</li>
<li>
<p><strong>ana-class100</strong>_XXX.tflite</p>
</li>
<li>100 neurons representing the classes from 0.0, 0.1, ... 9.8, 9.9</li>
</ul>
<h3 id="digits-with-11-classes-dig-class11_xxxtflite">Digits with 11 classes ("dig-class11_XXX.tflite")</h3>
<p>The digit type is a classical classification network, with 11 classes representing the numbers 0, 1, ... 9 and the special class "N". It is trained for the rolling ring of gas and electric meters. As there is sometime a status between two images, the special class "N" is representing Not-A-Number for the case, that the image cannot be unique classified to one number e.g. because it is between two digits. For this type the lowest amount of training data per type is needed, resulting in a large variety of type being already part of the training set.</p>
<h4 id="types-of-counters-trained_1">Types of counters trained:</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt="" src="../img/dig-class11/examp-dig1.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig2.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig3.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig4.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig13.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig12.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig9.jpg" /></td>
</tr>
<tr>
<td><img alt="" src="../img/dig-class11/examp-dig5.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig6.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig7.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig8.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig11.jpg" /></td>
<td><img alt="" src="../img/dig-class11/examp-dig10.jpg" /></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="training-data-needs_1">Training data needs</h4>
<ul>
<li>RGB images, with minimum size: 20x32 pixel</li>
<li>
<p>Typically 10 - 20 images (1-2 for each digit and an arbitrary number for the "N" class</p>
</li>
<li>
<p>Naming: x_ARBITRARY.jpg, where x = value 0 ... 9 + N</p>
</li>
</ul>
<h4 id="cnn-technical-details_1">CNN Technical details:</h4>
<h5 id="input_1">Input</h5>
<ul>
<li>20 x 32 RGB images</li>
</ul>
<h5 id="output_1">Output</h5>
<ul>
<li>11 neurons for image classification (last layer normalized to 1)</li>
<li>Neuron 0 to 9 represent the corresponding numbers "0" to "9"</li>
<li>Neron 10 represent the "Not-A-Number" class, telling, that the image is not uniquely classified</li>
</ul>
<h3 id="digits-with-rolling-results-dig-class100_xxxtflite-dig-cont_xxxtflite">Digits with rolling results ("dig-class100_XXX.tflite" &amp; "dig-cont_XXX.tflite")</h3>
<p>This type of network tries to overcome the problem, that there are intermediate values, when a rolling digit is between two numbers. Previous this was the "N" class. In this network type, there are also subdigit values trained, so that the intermediate state can be used as additional information for the algorithms. </p>
<h4 id="types-of-counters-trained_2">Types of counters trained:</h4>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>[[images/dig-cont/dig-cont_1.jpg)</td>
<td>[[images/dig-cont/dig-cont_2a.jpg)  [[images/dig-cont/dig-cont_2b.jpg)</td>
<td>[[images/dig-cont/dig-cont_3a.jpg)  [[images/dig-cont/dig-cont_3b.jpg) [[images/dig-cont/dig-cont_3c.jpg)</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h4 id="training-data-needs_2">Training data needs</h4>
<ul>
<li>RGB images, with minimum size: 20x32 pixel</li>
<li>
<p>Typically 100 - 200 images (1-2 for each possible position) </p>
</li>
<li>
<p>Naming: x.y_ARBITRARY.jpg, where x.y = 0.0, 0.1, ... 9.9 representing the intermediate state</p>
</li>
</ul>
<h4 id="cnn-technical-details_2">CNN Technical details:</h4>
<h5 id="input_2">Input</h5>
<ul>
<li>20 x 32 RGB images</li>
</ul>
<h5 id="output_2">Output</h5>
<ul>
<li><strong>dig-cont</strong>_XXX.tflite:</li>
<li>10 neurons representing the digits 0, 1, ... 9. The intermediate values are represented by weighted normalized values of two neighboring output neurons</li>
<li>
<p>needs to be converted to angle with arctan-hyperbolicus function</p>
</li>
<li>
<p><strong>dig-class100</strong>_XXX.tflite</p>
</li>
<li>100 neurons representing the classes from 0.0, 0.1, ... 9.8, 9.9</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../Choosing-the-Model/" class="btn btn-neutral float-left" title="Model Selection"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../ota/" class="btn btn-neutral float-right" title="Over-The-Air (OTA) Update">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/jomjol/AI-on-the-edge-device-docs" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../Choosing-the-Model/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../ota/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
